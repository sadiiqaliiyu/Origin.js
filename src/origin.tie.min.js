Origin.Tie=new function(){"use strict";function t(t){if(t!==Object(t))throw r.directorNotObject}function e(){for(var t in s)s[t].update()}function i(t,e){this.el=t,this.tieID=e,this.tiedData={},this.automatic(!0)}var r=function(){var t=new Error("Director must be an Object.");t.id="OGDirNotObj";var e=new Error;e["final"]=function(t,e){return this.message=t+" is already defined on element: "+e,this},e.id="OGTiePropOver";var i=new Error;i["final"]=function(t,e){return this.message='"'+t+'" was not found  in the director for "'+e+'"',this},i.id="OGDirUNDF";var r=new Error;r["final"]=function(t,e){return this.message='No such attribute "'+t+'" on '+e,this},r.id="OGAttrNULL";var n=new Error("Only HTML Elements are excepted.");return n.id="OGDomNonEl",{directorNotObject:t,overTied:e,objNotInDirector:i,attrNonExistent:r,htmlElOnly:n}}(),n={},a=0,s={},o=10,h=void 0;this.turnOn=function(){h=window.setInterval(e,o)},this.turnOff=function(){window.clearInterval(h),h=void 0},this.changeUpdateSpeed=function(t){o=t,h&&(this.turnOff(),this.turnOn())},i.prototype=new function(){function e(t,e){return function(){return Origin.calcPath(t,e)}}function i(t,e){for(var r=e||[],n=t.firstChild;n&&n!==t.lastChild;){try{var a=Origin.Tie.get(n);r.push(a),i(n,r)}catch(s){}n=n.nextSibling}return r}function a(t,e){var i=0,n=e.indexOf("."),a=e.substring(i,n),s=t[a];if(!s)throw r.objNotInDirector["final"](a);var o=e.substring(n+1,e.length);return{base:s,path:o}}this._defineTie=function(t,i,n,a,s,o){if(t in this.tiedData)throw r.overTied["final"](t,this.el);var h=e(i,n);this.tiedData[t]={elPropBase:a,elProp:s,objData:h,canWrite:o||!1,previousValue:null}},this._execPath=function(t,e,i,n,a){if("="===e[0]){var s="="===e[1],o=s?2:1,h=e.indexOf("."),u=e.substring(o,h),l=t[u];if(!l)throw r.objNotInDirector["final"](u,i);var f=e.substring(h+1,e.length);this._defineTie(i,l,f,n,a,s)}},this.update=function(){var t=!1;for(var e in this.tiedData){var i=this.tiedData[e],r=i.elPropBase[i.elProp],n=i.objData();r!==i.previousValue?(n.base[n.property]=r,t=!0):r!==n.value&&(i.elPropBase[i.elProp]=n.value,t=!0),i.previousValue=i.elPropBase[i.elProp]}return t},this.updateTree=function(){do{var t=!1,e=i(this.el,[this]);for(var r in e){var n=e[r];n.update()&&(t=!0)}}while(t)},this.save=function(){for(var t in this.tiedData){var e=this.tiedData[t],i=e.elPropBase[e.elProp];e.previousValue=i}},this.automatic=function(t){return t?void(s[this.tieID]=this):void delete s[this.tieID]},this.parse=function(e,r){try{t(e)}catch(n){throw n}var a=[this];r&&i(this.el,a);for(var s in a){var o=a[s];o._parseAttributes(e),o._parseStyles(e),o._parseContent(e),o.save(),o.update()}},this._parseAttributes=function(t){for(var e=this.el.attributes,i=0,r=e.length;r>i;i++){var n,a=e[i],s=a.name,o=a.value,h="attr-"+s;this.el[s]?n=this.el:(n=a,s="value"),this._execPath(t,o,h,n,s)}},this._parseContent=function(t){var e=this.el,i="innerHTML",r=e.innerHTML,n="attr-"+i,a=this.el;this._execPath(t,r,n,a,i)},this._parseStyles=function(t){var e=this.el.getAttribute("style");if(e){var i=e.split(";"),r=this.el.style;for(var n in i){var a=i[n],s=a.indexOf(":"),o=a.substr(0,s),h=a.substring(s+1,a.length),u="style-"+o;this._execPath(t,h,u,r,o)}}},this.tieAttributes=function(e,i){t(e);var r=this.el;for(var n in i){var s,o=i[n],h=o.name;if(r[h])s=r;else{null===r.getAttribute(h)&&r.setAttribute(h,"?"),h="value";for(var u=0,l=r.attributes.length;l>u;u++)r.attributes[u].name===o.name&&(s=r.attributes[u])}var f="attr-"+o.name,v=a(e,o.path);this._defineTie(f,v.base,v.path,s,h,o.canWrite)}this.save(),this.update()},this.tieStyles=function(e,i){t(e);var n=this.el;for(var s in i){var o=i[s],h=o.name,u=n.style;if(void 0===u[h])throw r.attrNonExistent["final"](h);var l="style-"+o.name,f=a(e,o.path);this._defineTie(l,f.base,f.path,u,h,o.canWrite)}this.save(),this.update()},this.untieAttributes=function(t){for(var e in t)delete this.tiedData["attr-"+t[e]]},this.untieStyles=function(t){for(var e in t)delete this.tiedData["style-"+t[e]]},this.untieAll=function(){this.tiedData={}},this.remove=function(){this.untieAll();var t=i(this.el,[this]);for(var e in t){var r=t[e];r.el.removeAttribute("data-origin-id"),delete s[r.tieID],delete n[r.tieID]}}},this.get=function(t){if(t instanceof HTMLElement==!1)throw r.htmlElOnly;return t.dataset.originId in n==!1?(t.dataset.originId=a++,n[a-1]=new i(t,a-1)):n[t.dataset.originId]}};